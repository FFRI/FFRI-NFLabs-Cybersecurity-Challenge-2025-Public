#!/bin/bash
set -xe

# Create a user with admin privileges
NEW_ADMIN_PASS='CYnFUPZ8v%X8iWzs'
gitlab-rails runner "user = Users::CreateService.new( \
    nil, username: 'r.nomura', email: 'r.nomura@mirai-itsystems.local', \
    name: '野村 令', password: '$NEW_ADMIN_PASS', \
    password_confirmation: '$NEW_ADMIN_PASS', \
    organization_id: Organizations::Organization.first.id, \
    skip_confirmation: true).execute"
gitlab-rails runner "user = User.find_by_username('r.nomura'); user.admin = true; user.save!"

# Create other users with non-admin privileges
C_SAKAMOTO_PASS='8iVhrFp%sCGLTa*7'
gitlab-rails runner "user = Users::CreateService.new( \
    nil, username: 'c.sakamoto', email: 'c.sakamoto@mirai-itsystems.local', \
    name: '坂本 千果', password: '$C_SAKAMOTO_PASS', \
    password_confirmation: '$C_SAKAMOTO_PASS', \
    organization_id: Organizations::Organization.first.id, \
    skip_confirmation: true).execute"

M_YAMADA_PASS='C0yYiQa6%3PH8OvK'
gitlab-rails runner "user = Users::CreateService.new( \
    nil, username: 'm.yamada', email: 'm.yamada@mirai-itsystems.local', \
    name: '山田 允', password: '$M_YAMADA_PASS', \
    password_confirmation: '$M_YAMADA_PASS', \
    organization_id: Organizations::Organization.first.id, \
    skip_confirmation: true).execute"

K_SAYAMA_PASS='46^zWCWk!crUOaOK'
gitlab-rails runner "user = Users::CreateService.new( \
    nil, username: 'k.sayama', email: 'k.sayama@mirai-itsystems.local', \
    name: '佐山 果歩', password: '$K_SAYAMA_PASS', \
    password_confirmation: '$K_SAYAMA_PASS', \
    organization_id: Organizations::Organization.first.id, \
    skip_confirmation: true).execute"
