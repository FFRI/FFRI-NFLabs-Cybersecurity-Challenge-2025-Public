external_url 'http://mirai-itsystems.local:8480'

gitlab_rails['time_zone'] = 'Asia/Tokyo'
gitlab_rails['gitlab_shell_ssh_port'] = 2222
gitlab_rails['db_prepared_statements'] = false

puma['worker_processes'] = 0
prometheus_monitoring['enable'] = false
sidekiq['concurrency'] = 10

nginx['listen_addresses'] = ["0.0.0.0"]
nginx['listen_port'] = 8480
nginx['listen_https'] = false
nginx['redirect_http_to_https'] = false

gitaly['configuration'] = {
    concurrency: [
      {
        'rpc' => "/gitaly.SmartHTTPService/PostReceivePack",
        'max_per_repo' => 3,
      }, {
        'rpc' => "/gitaly.SSHService/SSHUploadPack",
        'max_per_repo' => 3,
      },
    ],
    cgroups: {
        repositories: {
            count: 2,
        },
        mountpoint: '/sys/fs/cgroup',
        hierarchy_root: 'gitaly',
        memory_bytes: 500000,
        cpu_shares: 512,
    },
}

gitaly['env'] = {
  'GITALY_COMMAND_SPAWN_MAX_PARALLEL' => '2'
}

gitlab_rails['env'] = {
  'MALLOC_CONF' => 'dirty_decay_ms:1000,muzzy_decay_ms:1000'
}

gitaly['env'] = {
  'MALLOC_CONF' => 'dirty_decay_ms:1000,muzzy_decay_ms:1000'
}