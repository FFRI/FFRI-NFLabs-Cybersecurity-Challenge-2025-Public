using System.Reflection;

namespace MonitorIISTask
{
    internal class Monitor
    {

        private NotifierWrapper _notifier;

        public Monitor(string dllName, string functionName) 
        {
         
            _notifier = new NotifierWrapper(dllName, functionName);

        }
        public void Start(string url)
        {
            if (!IsHealthy(url))
            {
                NotifyFailure();
            }
        }
        
        private bool IsHealthy(string url)
        {
            
            // 未実装なので常にfalseを返す
            Console.WriteLine("[Debug] Always return false");
            return false;
        }

        private void NotifyFailure()
        {

            try
            {
                _notifier.Send("IIS has some problem");
            }
            catch (Exception ex)
            {
                Console.WriteLine($"[!] 通知処理失敗: {ex.Message}");
            }

        }
    }
}
