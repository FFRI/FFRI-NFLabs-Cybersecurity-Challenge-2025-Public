# Salted Hash Hunt - 作問者向け手順書

このドキュメントは「Salted Hash Hunt」CTF問題の準備と運用のためのガイドです。高校生向け「情報I」の範囲内で解答可能な設計になっています。

## 1. データ生成方法

### 1.1 環境準備

1. Python 3.13以上の環境を用意します
2. `rockyou.txt` パスワードリストを取得します
   - 多くのCTFでは標準的に使用されるリストです
   - 取得できない場合は任意のパスワードリストで代用可能です

### 1.2 生成方法

`build.py` スクリプトを実行して問題データを生成します：

```bash
# 基本パラメータ（デフォルト値）
python build.py

# カスタムパラメータの例
python build.py --target-user tanaka --hash-count 3000 --fp-count 3000 --high-iter-ratio 0.6
```

### 1.3 パラメータ解説

| パラメータ | 説明 | デフォルト値 |
|-----------|------|-------------|
| --target-user | ターゲットユーザー名 | matsuki |
| --hash-count | System Aのハッシュエントリ数 | 5000 |
| --fp-count | System Bのフィンガープリント数 | 5000 |
| --high-iter-ratio | 高反復回数の割合（0〜1） | 0.45 |

### 1.4 生成結果

スクリプト実行後、以下のファイルが `data` ディレクトリに生成されます：

1. `systemA_auth.csv` - ソルト、反復回数、ハッシュ値のリスト
2. `systemB_fingerprint.csv` - フィンガープリントとユーザー名のリスト
3. `flag.txt` - フラグとパラメータ情報

## 2. ソルバ検証手順

### 2.1 基本検証（basic_solver.py）

```bash
# 基本実装版ソルバーの実行
python basic_solver.py

# ユーザー名指定（デフォルトは matsuki）
python basic_solver.py --target-user tanaka
```

### 2.2 最適化版検証（smart_solver.py）

```bash
# 最適化実装版ソルバーの実行
python smart_solver.py

# ユーザー名指定
python smart_solver.py --target-user tanaka
```

### 2.3 検証ポイント

1. 正しいフラグが出力されるか
2. 実行時間が適切か（`basic_solver.py` は通常1〜2分程度、`smart_solver.py` はその1/3〜1/6程度）
3. 残り時間の推定が正しく表示されるか
4. パスワード要件（12文字以上、大文字・小文字・数字混在）を満たすフラグが生成されているか

## 3. 難易度調整ガイド

難易度を調整したい場合は、以下のパラメータを変更できます：

### 3.1 簡単にする方法

- `--hash-count` と `--fp-count` を小さくする（例: 1000）
  - データ量が減り、処理が高速になります
- `--high-iter-ratio` を小さくする（例: 0.1）
  - 低反復回数のエントリが増え、検証が高速になります

### 3.2 難しくする方法

- `--hash-count` と `--fp-count` を大きくする（例: 10000以上）
  - データ量が増え、処理に時間がかかります
- `--high-iter-ratio` を大きくする（例: 0.9）
  - 高反復回数のエントリが増え、検証に時間がかかります
- `build.py` のコードを修正し、パスワード選択条件を変更
  - 例: 15文字以上、特殊文字も含むなど

### 3.3 バランス調整のコツ

1. 実際に生成＆検証を行って所要時間を測定
2. 目標とする解答時間の1/3〜1/2程度になるようパラメータを調整
3. 異なる環境でもテストして、環境依存性を確認

## 4. 教育的価値の最大化

### 4.1 重要な学習ポイント

この問題を通じて学べる重要な概念：

1. ハッシュ関数の一方向性
2. ソルトの重要性
3. 反復ハッシュ（キーストレッチング）の効果
4. 情報漏洩の組み合わせリスク
5. パスワード強度の重要性

### 4.2 発展的な話題

問題解説時に触れると良い発展的な話題：

- パスワードマネージャーの重要性
- 多要素認証の必要性
- 同一パスワードの使い回しリスク
- ゼロトラスト・セキュリティの概念

## 5. トラブルシューティング

| 問題 | 対応策 |
|-----|-------|
| rockyou.txtが見つからない | データディレクトリに手動でコピー |
| データ生成に時間がかかる | hash-countとfp-countを小さくする |
| ソルバーが解を見つけられない | build.pyを再実行して別のパスワードで試す |
| エンコーディングエラー | ファイルをUTF-8で開いていることを確認 |

## 6. メンテナンス情報

- 作成日: 2025年5月
- 対象Python: 3.13以上
- 想定実行環境: Windows/macOS/Linux
- 使用ライブラリ: 標準ライブラリのみ
